(()=>{"use strict";const t={keyboard:{aux:{}},mouse:{x:0,y:0,clicked:!1},init:function(){t.keyboard.ARROW_LEFT=new e(37),t.keyboard.ARROW_UP=new e(38),t.keyboard.ARROW_RIGHT=new e(39),t.keyboard.ARROW_DOWN=new e(40),t.keyboard.ENTER=new e(13),t.keyboard.ALT=new e(18),t.keyboard.ESC=new e(27),t.keyboard.SPACE=new e(32),t.keyboard.O=new e(79),t.keyboard.C=new e(67),t.keyboard.V=new e(86),t.keyboard.T=new e(84)},keyDown:function(e){let o=t.keyboard.aux[e];o&&o.keyDown()},mouseClick:function(e,o){t.mouse.clicked=!0,t.mouse.x=e,t.mouse.y=o},reset:function(){Object.keys(t.keyboard).forEach(((e,o)=>{t.keyboard[e].execute&&t.keyboard[e].execute()})),t.mouse.clicked=!1}};function e(e){this.isPressed=!1,this.keyCode=e,t.keyboard.aux[e]=this}e.prototype.keyDown=function(){this.isPressed=!0},e.prototype.execute=function(){return!!this.isPressed&&(this.isPressed=!1,!0)};const o=t,i={ctx:null,w:null,h:null,bg:"#000",menuBg:"#151515",color:"#FFF",fonts:{menu:"30px Arial",text:"14px Arial",color:"#F00"}},n={gradient:0,lerp:(t,e,o)=>t+o*(e-t),fontHeight:t=>parseInt(t.match(/\d+/)),updateGradient:t=>{n.gradient=.5*Math.sin(.003*t)+.5}},s=n,c={stack:[],screenExists:()=>c.stack.length>0,addScreen:t=>c.stack.unshift(t),removeScreen:()=>c.stack.shift(),draw:()=>c.stack[0].draw(),update:t=>c.stack[0].update(t)},h=c,r=(t,e)=>t.x<e.x&&t.x+t.w>e.x&&t.y<e.y&&t.y+t.h>e.y;function a(t,e,o,i,n,s=[],c=2){this.x=t,this.y=e,this.w=o,this.h=i,this.color=n,this.padding=c,this.options=s,this.selectedOption=0,this.arrangeOptions()}a.prototype.draw=function(){let t,e=i.ctx;for(t in e.fillStyle=this.color,e.fillRect(this.x,this.y,this.w,this.h),this.options)this.options[t].draw(this.selectedOption==t)},a.prototype.update=function(t){if(o.keyboard.ENTER.execute()&&this.options[this.selectedOption].execute(),o.keyboard.ARROW_UP.execute()&&(this.selectedOption=(this.selectedOption+this.options.length-1)%this.options.length),o.keyboard.ARROW_DOWN.execute()&&(this.selectedOption=(this.selectedOption+1)%this.options.length),o.mouse.clicked&&r(this,o.mouse))for(let t in this.options)if(r(this.options[t],o.mouse)){this.options[t].execute();break}},a.prototype.arrangeOptions=function(t){let e,o,i=0;for(e in this.options)i+=this.options[e].h+this.padding;for(e in o=(this.h-i)/2,this.options)this.options[e].y=o+this.y,this.options[e].x=this.x,this.options[e].w=this.w,o+=this.options[e].h+this.padding};const l=a;function d(t,e,o,i){this.text=t,this.font=e,this.color=o,this.callback=i,this.x=0,this.y=0,this.w=0,this.h=s.fontHeight(this.font)}d.prototype.draw=function(t){let e,o=i.ctx;if(o.font=this.font,t){let t=s.lerp(120,220,s.gradient);o.fillStyle=`rgb(255, ${t}, ${t})`}else o.fillStyle=this.color;e=o.measureText(this.text).width,o.fillText(this.text,this.x+(this.w-e)/2,this.y+this.h)},d.prototype.execute=function(){this.callback()};const u=d;function p(){this.resetDay()}p.prototype.realTimeToGameTimeFactor=.015,p.prototype.update=function(t){this.seconds+=t*this.realTimeToGameTimeFactor},p.prototype.resetDay=function(){this.seconds=28800},p.prototype.getHour=function(){return~~(this.seconds/3600)%24},p.prototype.getMinute=function(){return~~(this.seconds%3600/60)};const f=p;function y(){this.clock=new f}y.prototype.update=function(t){this.clock.update(t)};const w=y;function k(){this.state=new w}k.prototype.update=function(t){this.state.update(t)},k.prototype.draw=function(){let t,e=i.ctx,o=`${`0${this.state.clock.getHour()}`.slice(-2)}:${`0${this.state.clock.getMinute()}`.slice(-2)}`;e.fillStyle=i.bg,e.fillRect(0,0,i.w,i.h),e.font=i.fonts.menu,e.fillStyle=i.fonts.color,t=e.measureText(o).width,e.fillText(o,i.w-t,i.h)};const x=k;function m(){this.menu=new l(0,this.titleHeight,i.w,i.h-this.titleHeight,i.menuBg,[new u("Start",i.fonts.menu,i.fonts.color,(function(){h.addScreen(new x)})),new u("Options",i.fonts.menu,i.fonts.color,(function(){console.log(this)}))])}m.prototype.update=function(t){this.menu.update(t)},m.prototype.draw=function(){let t,e,o=i.ctx;o.fillStyle=i.bg,o.fillRect(0,0,i.w,i.h),o.font=i.fonts.menu,o.fillStyle=i.fonts.color,t=o.measureText("MD").width,e=s.fontHeight(o.font),o.fillText("MD",(i.w-t)/2,(this.titleHeight+e)/2),this.menu.draw()},m.prototype.titleHeight=200,m.prototype.menuPadding=100;const g=m;window.onload=function(){let t=document.getElementById("main_canvas");i.ctx=t.getContext("2d"),i.w=t.width,i.h=t.height,o.init(),document.onkeydown=t=>o.keyDown(t.keyCode),t.addEventListener("click",(e=>o.mouseClick(e.pageX-t.offsetLeft,e.pageY-t.offsetTop)),!1),h.addScreen(new g),window.requestAnimationFrame(O)};var b=0;function O(t){let e=t-b;b=t,s.updateGradient(t),h.draw(),h.update(e),o.reset(),window.requestAnimationFrame(O)}})();